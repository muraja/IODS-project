# Linear Regression & Model Validation

*Describe the work you have done this week and summarize your learning.*

-   Describe your work and results clearly.
-   Assume the reader has an introductory course level understanding of writing and reading R code as well as statistical methods.
-   Assume the reader has no previous knowledge of your data or the more advanced methods you are using.

```{r}
date()
```

#### The data

```{r}
# loading the dataset
library(tidyverse)
l14 <- read_csv("C:/Users/SM/Documents/IODS-project/data/learning2014.csv")
# inspecting the data
l14 # viewing the data table
dim(l14) # dimensions of the dataset
str(l14) # structure of the dataset
```

This dataset has 7 variables, one of which is categorical (gender) and 6 of which are numerical. The variables *deep*, *stra* and *surf* refer to learning methods. The variable *points* refer to exam score, which is the outcome variable of this dataset.

#### Graphical overview

> *Show a graphical overview of the data and show summaries of the variables in the data. Describe and interpret the outputs, commenting on the distributions of the variables and the relationships between them. (0-3 points)*

```{r}
library(GGally)
library(ggplot2)

# creating a plot matrix
p <- ggpairs(l14, 
             mapping = aes(col = gender, alpha = 0.3), 
             lower = list(combo = wrap("facethist", bins = 20)))
p

# summary of the variable data
summary(l14)
```

Attitude is correlated with points.

#### Regression model

> *Choose three variables as explanatory variables and fit a regression model where exam points is the target (dependent, outcome) variable. Show a summary of the fitted model and comment and interpret the results. Explain and interpret the statistical test related to the model parameters. If an explanatory variable in your model does not have a statistically significant relationship with the target variable, remove the variable from the model and fit the model again without it. (0-4 points)*

As we could see from the earlier graph p, the strongest correlations with points are with *attitude*, *stra* and *surf* so I'll choose them as the 3 explanatory variables.

```{r}
model1 <- lm(points ~ attitude + stra + surf, data = l14)
summary(model1)
```

Attitude is the only variable that has a statistically significant relationship with the target variable *points*. I'll remove the variable with the lowest t-score, *surf*, from the model.

```{r}
model2 <- lm(points ~ attitude + stra, data = l14)
summary(model2)
```

The t-score of *stra* is still 0.08927, so I'm removing it from the model.

```{r}
model3 <- lm(points ~ attitude, data = l14)
summary(model3)
```

Conclusion:

> *Using a summary of your fitted model, explain the relationship between the chosen explanatory variables and the target variable (interpret the model parameters). Explain and interpret the multiple R-squared of the model. (0-3 points)*

The higher the *attitude* score, ie. the more positive attitude towards learning?, the higher exam points can be expected. *Attitude* explains about 19 % of the variation of exam *points*. It's noteworthy that r^2^ didn't change much in removing the other explanatory variables: with 3 variables it was less than 0.02 higher.

#### Diagnostic plots

> *Produce the following diagnostic plots: Residuals vs Fitted values, Normal QQ-plot and Residuals vs Leverage. Explain the assumptions of the model and interpret the validity of those assumptions based on the diagnostic plots. (0-3 points)*

```{r}
par(mfrow = c(2,2))
model3 %>% plot(which = c(1,2,5))

```

Assumptions of the model:

Interpretations of the validity of the assumptions:
